<body>
  <!-- import src scripts -->
  <script src="../src/array-util.es6.js"></script>
  <script src="../src/dom-util.es6.js"></script>
  <script src="../src/float-buffer.es6.js"></script>
  <script src="../src/math-util.es6.js"></script>
  <script src="../src/microphone-node.es6.js"></script>
  <script src="../src/sound-fft.es6.js"></script>

  <!-- layout -->
  <div class="container">
    <h1>MicrophoneNode</h1>
    <div id="fft-container"></div>
  </div>

  <!-- demo script -->
  <script>
    let fftEl = document.getElementById('fft-container');
    var fftAttached = false;

    // init microphone
    let soundFFT = null;
    const mic = new MicrophoneNode(null, () => {
      soundFFT = new SoundFFT(mic.getContext(), mic.getNode());
    }, (error) => {
      fftEl.innerHTML = '[MicrophoneNode ERROR] :: ' + error;
    });

    // animate fft debug canvas
    function animateFFT() {
      requestAnimationFrame(() => {
        animateFFT();
        if(soundFFT) {
          soundFFT.update();
          soundFFT.drawDebug();
          if(!fftAttached) {
            fftAttached = true;
            fftEl.appendChild(soundFFT.getDebugCanvas());
            soundFFT.getDebugCanvas().setAttribute('style', null);
          }
        }
      });
    }
    animateFFT();
  </script>
</body>

<!-- Wrap demo with layout -->
<script async src="./_demo-wrapper.es6.js"></script>
